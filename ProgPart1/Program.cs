using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System;
using System.Media;
using System.IO;

namespace ProgPart1
{
    class Program
    {
        static void Main(string[] args)
        {
            string wavPath = @"C:\Users\paras\source\repos\ProgPart1\ProgPart1\Welcome.wav";

            if (File.Exists(wavPath))
            {
                new Music(wavPath).Play();
            }
            else
            {
                Console.WriteLine("WAV file not found at: " + wavPath);
            }

            Console.WriteLine("===========================================");
            Console.WriteLine("Welcome to the Cybersecurity Awareness Bot!");
            Console.WriteLine("===========================================");
            //
            string asciiArt = @"
                
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++*%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++++++++*%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++++++#%%%#++++++#%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++++++%%%%%%%%%%%+++++++#%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++++++++%%%%%%%%%%%%%%%%%%%++++++++*#%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##**++++++++++#%%%%%%%%%%%+++++%%%%%%%%%%%*++++++++++**##%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%++++++++++++++#%%%%%%%%%%%%%%%%*+++++*%%%%%%%%%%%%%%%%#++++++++++++++%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++++%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%%%%%%%%%*+++++++++++++++++++++++++*%%%%%%%%%%%%%%%%%%+++%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++%%%%%%%%%%%%%%%*+++++++++++++++++++++++++++++++*%%%%%%%%%%%%%%%++*%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++#%%%%%%%%%%%%%+++*%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++%%%%%%%%%%%%%#++*%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%++*%%%%%%%%%%%%*++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++*%%%%%%%%%%%%*++%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%%#+++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++#%%%%%%%%%%%+++%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%++++++#%%%%#....:%%%%%%%%%-....+%%%%#++++++%%%%%%%%%+++%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%++++++#%%%%=.....*%%%%%%%#.....:%%%%#++++++%%%%%%%%%+++%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++*%%%%%%%%++++++#%%%%%=...+%%%%%%%%%#...:%%%%%#++++++%%%%%%%%*++%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%++++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++++++%%%%%%%%+++%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++#%%%%%%%++++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++++++%%%%%%%#++*%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%+++#%%%%%%%%+++++++++++++%%%%%%%%#+++%%%%%%%%%%+++%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++*%%%%%%%%%*++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++*%%%%%%%%%*++*%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%+++*%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++%%%%%%%%%%+++%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++%%%%%%%%%%*+++++++++++++++++++++++++++++++*%%%%%%%%%%+++%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++*%%%%%%%%%%%%#*+++++++++++++++++++++++*#%%%%%%%%%%%%*++*%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++#%%%%%%%%%%%#+++++++++%%%%%%%+++++++++*%%%%%%%%%%%#+++%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++#%%%%%%%%*++++++++++%%*+++*%%++++++++++*%%%%%%%%#+++%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++*%%%%%#+++++++++++=%%+++++%%=+++++++++++#%%%%%#+++%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++*%%%*++++++++++++#%%%%%%%%%%*+++++++++++*%%%*+++%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++%#++++++++++++#%%%%%%%%%%%%++++++++++++*%+++*%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++++++++++++++++#%%%%+++%%%%%++++++++++++++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++++++++++++++%%%%%+++%%%%%+++++++++++++++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++++++++++++%%%%%#+#%%%%%+++++++++++++*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++++++++++#%%%%%%%%%%%%++++++++++++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*++++++++++###########+++++++++++%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*+++++++++++++++++++++++++++*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+++++++++++++++++++++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++++++++++++++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++++++++++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+++#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=.....+%:.:%%%%..=%=......=%%#.......%%......:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%..-%%%-+%%-.:%%..+%%=.-%%%:.+%#..%%%%%%%..*%%*..%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-..%%%%%%%%%-.:..*%%%=..:...:%%#..====#%%..*%%#..%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-..%%%%%%%%%%+..#%%%%=.-##+..-%#..++++%%%......:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%..-%%%-+%%%%#..%%%%%=.-%%%=.:%#..%%%%%%%..*%=..%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=.....+%%%%#..%%%%%=......:%%#.......#%..*%%*..*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+....:*%%.......#%%*....:#%%..*%%%+.:%#.....:+%%#..%#........*..%%%%=..%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%+..%%%-%%%..#%%%%%%:.:%%#.-%%..*%%%+.:%#..#%%:.:%#..%%%%#..%%%%#..%%=..%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%...-#%%%%..=+++#%-..%%%%%%%%..*%%%+.:%#..#%%+.:%#..%%%%#..%%%%%%..=..%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%+-...%%..----#%-.:%%%%%%%%..*%%%+.:%#......-%%#..%%%%#..%%%%%%%..:%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-%%%%..%%..#%%%%%#..=%%%+%%%:.=%%%:.-%#..#%..-%%#..%%%%#..%%%%%%%..+%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%*......+%%.......#%%-.....=%%%:.....=%%#..#%%-.:%#..%%%%#..%%%%%%%..*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%=:::-#%%%%%-..:%%%#:::::-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:.%%+.+%%-.+%%+.-%%##.:##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:.....%%#.-%%%%=.*%%%.-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:.%%%..%%.:%%%%:.#%%%.-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%:.....+%%#:.::..#%%%%.-%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                
            ";
            Console.WriteLine(asciiArt);

            Console.Write("Please enter your name: ");
            string name = Console.ReadLine();

            // Keep prompting the user until a valid name is entered
            while (string.IsNullOrWhiteSpace(name))
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.WriteLine("Name cannot be empty. Please enter your name:");
                Console.ResetColor();
                name = Console.ReadLine();
            }

            Console.ForegroundColor = ConsoleColor.Cyan;
            Console.WriteLine("Hey there " + name + "!!!" + " ,I'm your Cybersecurity Awareness Assistant.");
            Console.WriteLine($"Nice to meet you, {name}!");
            Console.ResetColor();

            Console.ForegroundColor = ConsoleColor.Green;
            Console.WriteLine("Let’s learn how to stay safe online!");
            Console.ResetColor();

            // Create an instance of HandleUserQuestions
            HandleUserQuestions handler = new HandleUserQuestions("", name);

            // Loop to keep asking questions
            while (true)
            {
                Console.WriteLine("Ask a question or type 'exit' to quit:");
                string question = Console.ReadLine();

                // Check if the user wants to exit
                if (string.Equals(question, "exit", StringComparison.OrdinalIgnoreCase))
                {
                    Console.WriteLine("Goodbye! Stay safe online!");
                    break;
                }

                // Update the question in the handler and process it
                handler = new HandleUserQuestions(question, name);
                handler.ProcessQuestion();
            }
        }

    }
}
